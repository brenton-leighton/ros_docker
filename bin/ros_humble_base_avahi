#!/usr/bin/env bash

SCRIPT_PATH=$(realpath "${0}")
SCRIPT_DIR=$(dirname "${SCRIPT_PATH}")

export COMPOSE_PROJECT_NAME="ros-humble-base-avahi"
PROJECT_DIR="${SCRIPT_DIR}/../humble/${COMPOSE_PROJECT_NAME}"

# Parse options to set $BUILD
source "${SCRIPT_DIR}/_get_build_opt"

# Home directory on the host
export HOST_HOME_PATH="${PROJECT_DIR}/home"
mkdir -p "${HOST_HOME_PATH}/ros2_ws/src"

# Other variables
export USER_ID=$(id -u)

# docker compose run
docker compose --file "${PROJECT_DIR}/compose.yaml" run ${BUILD} --rm default ${@}
